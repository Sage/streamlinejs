/*** Generated by streamline 0.2.2 - DO NOT EDIT ***/ var __rt=require('streamline/lib/callbacks/runtime').runtime(__filename),__func=__rt.__func,__cb=__rt.__cb,__forIn=__rt.__forIn,__future=__rt.__future,__propagate=__rt.__propagate,__trap=__rt.__trap,__setEF=__rt.__setEF,__g=__rt.__g; (function(exports) {


































 "use strict";







 exports.each = function exports_each__1(_, array, fn, thisObj) { var len, i; var __frame = { name: "exports_each__1", line: 44 }; return __func(_, this, arguments, exports_each__1, 0, __frame, function __$exports_each__1() {
 if ((!array || !array.length)) { return _(null); } ;

 len = array.length;
 i = 0; var __2 = false; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_each__1() { __more = false; if (__2) { i++; } else { __2 = true; } ; var __1 = (i < len); if (__1) {
 return fn.call(thisObj, __cb(_, __frame, 5, 3, function __$exports_each__1() { while (__more) { __loop(); }; __more = true; }), array[i], i); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_each__1() {
 return _(null, array); }); }); };




 exports.map = function exports_map__2(_, array, fn, thisObj) { var result, len, i; var __frame = { name: "exports_map__2", line: 55 }; return __func(_, this, arguments, exports_map__2, 0, __frame, function __$exports_map__2() {
 if (!array) {
 return _(null, array); } ;
 result = [];
 len = array.length;
 i = 0; var __3 = false; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_map__2() { __more = false; if (__3) { i++; } else { __3 = true; } ; var __2 = (i < len); if (__2) {
 return fn.call(thisObj, __cb(_, __frame, 6, 15, function ___(__0, __1) { result[i] = __1; while (__more) { __loop(); }; __more = true; }), array[i], i); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_map__2() {
 return _(null, result); }); }); };




 exports.filter = function exports_filter__3(_, array, fn, thisObj) { var result, len, i, elt; var __frame = { name: "exports_filter__3", line: 67 }; return __func(_, this, arguments, exports_filter__3, 0, __frame, function __$exports_filter__3() {
 if (!array) {
 return _(null, array); } ;
 result = [];
 len = array.length;
 i = 0; var __3 = false; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_filter__3() { __more = false; if (__3) { i++; } else { __3 = true; } ; var __2 = (i < len); if (__2) {
 elt = array[i];
 return fn.call(thisObj, __cb(_, __frame, 7, 7, function ___(__0, __1) { return (function __$exports_filter__3(__then) { if (__1) {
 result.push(elt); __then(); } else { __then(); } ; })(function __$exports_filter__3() { while (__more) { __loop(); }; __more = true; }); }), elt); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_filter__3() {

 return _(null, result); }); }); };




 exports.every = function exports_every__4(_, array, fn, thisObj) { var len, i; var __frame = { name: "exports_every__4", line: 82 }; return __func(_, this, arguments, exports_every__4, 0, __frame, function __$exports_every__4() {
 if (!array) { return _(null); } ;

 len = array.length;
 i = 0; var __4 = false; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_every__4() { __more = false; if (__4) { i++; } else { __4 = true; } ; var __3 = (i < len); if (__3) {
 return fn.call(thisObj, __cb(_, __frame, 5, 8, function ___(__0, __2) { var __1 = !__2; return (function __$exports_every__4(__then) { if (__1) {
 return _(null, false); } else { __then(); } ; })(function __$exports_every__4() { while (__more) { __loop(); }; __more = true; }); }), array[i]); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_every__4() {

 return _(null, true); }); }); };




 exports.some = function exports_some__5(_, array, fn, thisObj) { var len, i; var __frame = { name: "exports_some__5", line: 95 }; return __func(_, this, arguments, exports_some__5, 0, __frame, function __$exports_some__5() {
 if (!array) { return _(null); } ;

 len = array.length;
 i = 0; var __3 = false; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_some__5() { __more = false; if (__3) { i++; } else { __3 = true; } ; var __2 = (i < len); if (__2) {
 return fn.call(thisObj, __cb(_, __frame, 5, 7, function ___(__0, __1) { return (function __$exports_some__5(__then) { if (__1) {
 return _(null, true); } else { __then(); } ; })(function __$exports_some__5() { while (__more) { __loop(); }; __more = true; }); }), array[i]); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_some__5() {

 return _(null, false); }); }); };




 exports.reduce = function exports_reduce__6(_, array, fn, v, thisObj) { var len, i; var __frame = { name: "exports_reduce__6", line: 108 }; return __func(_, this, arguments, exports_reduce__6, 0, __frame, function __$exports_reduce__6() {
 if (!array) {
 return _(null, v); } ;
 len = array.length;
 i = 0; var __3 = false; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_reduce__6() { __more = false; if (__3) { i++; } else { __3 = true; } ; var __2 = (i < len); if (__2) {
 return fn.call(thisObj, __cb(_, __frame, 5, 7, function ___(__0, __1) { v = __1; while (__more) { __loop(); }; __more = true; }), v, array[i], i, array); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_reduce__6() {

 return _(null, v); }); }); };




 exports.reduceRight = function exports_reduceRight__7(_, array, fn, v, thisObj) { var len, i; var __frame = { name: "exports_reduceRight__7", line: 120 }; return __func(_, this, arguments, exports_reduceRight__7, 0, __frame, function __$exports_reduceRight__7() {
 if (!array) {
 return _(null, v); } ;
 len = array.length;
 i = (len - 1); var __3 = false; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_reduceRight__7() { __more = false; if (__3) { i--; } else { __3 = true; } ; var __2 = (i >= 0); if (__2) {
 return fn.call(thisObj, __cb(_, __frame, 5, 7, function ___(__0, __1) { v = __1; while (__more) { __loop(); }; __more = true; }), v, array[i], i, array); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_reduceRight__7() {

 return _(null, v); }); }); };







 exports.sort = function exports_sort__8(_, array, compare, beg, end) {



 function _qsort(_, beg, end) { var tmp, mid, o, nbeg, nend; var __frame = { name: "_qsort", line: 139 }; return __func(_, this, arguments, _qsort, 0, __frame, function __$_qsort() {
 if ((beg >= end)) { return _(null); } ; return (function __$_qsort(__then) {


 if ((end == (beg + 1))) {
 return compare(__cb(_, __frame, 5, 8, function ___(__0, __2) { var __1 = (__2 > 0); return (function __$_qsort(__then) { if (__1) {
 tmp = array[beg];
 array[beg] = array[end];
 array[end] = tmp; __then(); } else { __then(); } ; })(function __$_qsort() { return _(null); }); }), array[beg], array[end]); } else { __then(); } ; })(function __$_qsort() {




 mid = Math.floor((((beg + end)) / 2));
 o = array[mid];
 nbeg = beg;
 nend = end; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$_qsort() { __more = false;

 var __4 = (nbeg <= nend); if (__4) { return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$_qsort() { __more = false; return (function __$_qsort(_) { return (function __$_qsort(_) {
 var __1 = (nbeg < end); if (!__1) { return _(null, __1); } ; return compare(__cb(_, __frame, 19, 25, function ___(__0, __3) { var __2 = (__3 < 0); return _(null, __2); }), array[nbeg], o); })(__cb(_, __frame, -138, 17, _)); })(__cb(_, __frame, -138, 17, function ___(__0, __5) { if (__5) {
 nbeg++; while (__more) { __loop(); }; __more = true; } else { __break(); } ; })); }); do { __loop(); } while (__more); __more = true; })(function __$_qsort() { return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$_qsort() { __more = false; return (function __$_qsort(_) { return (function __$_qsort(_) {

 var __1 = (beg < nend); if (!__1) { return _(null, __1); } ; return compare(__cb(_, __frame, 22, 25, function ___(__0, __3) { var __2 = (__3 < 0); return _(null, __2); }), o, array[nend]); })(__cb(_, __frame, -138, 17, _)); })(__cb(_, __frame, -138, 17, function ___(__0, __7) { if (__7) {
 nend--; while (__more) { __loop(); }; __more = true; } else { __break(); } ; })); }); do { __loop(); } while (__more); __more = true; })(function __$_qsort() {

 if ((nbeg <= nend)) {
 tmp = array[nbeg];
 array[nbeg] = array[nend];
 array[nend] = tmp;
 nbeg++;
 nend--; } ; while (__more) { __loop(); }; __more = true; }); }); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$_qsort() { return (function __$_qsort(__then) {



 if ((nbeg < end)) {
 return _qsort(__cb(_, __frame, 35, 4, __then), nbeg, end); } else { __then(); } ; })(function __$_qsort() { return (function __$_qsort(__then) {
 if ((beg < nend)) {
 return _qsort(__cb(_, __frame, 37, 4, __then), beg, nend); } else { __then(); } ; })(_); }); }); }); }); }; var __frame = { name: "exports_sort__8", line: 135 }; return __func(_, this, arguments, exports_sort__8, 0, __frame, function __$exports_sort__8() { beg = (beg || 0); end = ((end == null) ? (array.length - 1) : end);

 return _qsort(__cb(_, __frame, 43, 2, function __$exports_sort__8() {
 return _(null, array); }), beg, end); }); };








 exports.eachKey = function exports_eachKey__9(_, obj, fn, thisObj) { var key; var __frame = { name: "exports_eachKey__9", line: 188 }; return __func(_, this, arguments, exports_eachKey__9, 0, __frame, function __$exports_eachKey__9() {
 if (!obj) {
 return _(null, obj); } ;
 var __1 = __forIn(obj); var __2 = 0; return (function ___(__break) { var __more; var __loop = __cb(_, __frame, 0, 0, function __$exports_eachKey__9() { __more = false; var __3 = (__2 < __1.length); if (__3) { key = __1[__2++]; return (function __$exports_eachKey__9(__then) {
 if (Object.prototype.hasOwnProperty.call(obj, key)) {
 return fn.call(thisObj, __cb(_, __frame, 5, 4, __then), key, obj[key]); } else { __then(); } ; })(function __$exports_eachKey__9() { while (__more) { __loop(); }; __more = true; }); } else { __break(); } ; }); do { __loop(); } while (__more); __more = true; })(function __$exports_eachKey__9() {

 return _(null, obj); }); }); };





 exports.spray = function(fns, max) {
 return new function() {

 var funnel = exports.funnel(max);
 this.collect = function(callback, count, trim) {
 if ((typeof (callback) != "function")) {
 throw new Error("invalid call to collect: no callback") };
 var results = (trim ? [] : new Array(fns.length));
 count = ((count < 0) ? fns.length : Math.min(count, fns.length));
 if ((count == 0)) {
 return callback(null, results) };
 var collected = 0;
 for (var i = 0; (i < fns.length); i++) {
 (function(i) {
 funnel(function(err, result) {
 if (err) {
 return callback(err) };
 if (trim) {
 results.push(result); } else {

 results[i] = result; };
 if ((++collected == count)) {
 return callback(null, results) };
 }, fns[i]);
 })(i); }; };


 this.collectOne = function(callback) {
 return this.collect(function(err, result) {
 return callback(err, (result && result[0]));
 }, 1, true); };

 this.collectAll = function(callback) {
 return this.collect(callback, -1, false); }; }; };


















 exports.funnel = function(max) {
 max = ((typeof max == "undefined") ? -1 : max);
 var queue = [];
 var active = 0;

 return function(callback, fn) {

 if ((max < 0)) {
 return fn(callback) };

 queue.push({
 fn: fn,
 cb: callback });


 function _doOne() {
 var current = queue.splice(0, 1)[0];
 if (!current.cb) {
 return current.fn() };
 active++;
 current.fn(function(err, result) {
 active--;
 current.cb(err, result);
 while (((active < max) && (queue.length > 0))) { _doOne();; }; }); };




 while (((active < max) && (queue.length > 0))) { _doOne();; }; }; };







 exports.collect = function exports_collect__10(_, futures) { var __frame = { name: "exports_collect__10", line: 289 }; return __func(_, this, arguments, exports_collect__10, 0, __frame, function __$exports_collect__10() {
 return exports.map(__cb(_, __frame, 1, 9, _), futures, function __1(_, future) { var __frame = { name: "__1", line: 290 }; return __func(_, this, arguments, __1, 0, __frame, function __$__1() {
 return future(__cb(_, __frame, 1, 10, _)); }); }); }); };




 var globals = require("streamline/lib/globals");
 exports.setContext = function(ctx) {
 var old = globals.context;
 globals.context = ctx;
 return old; };

 exports.getContext = function() {
 return globals.context; };










 exports.nextTick = (((typeof process === "object") && (typeof process.nextTick === "function")) ? process.nextTick : function(callback) {

 setTimeout(function() { callback(); }, 0); });







 exports.apply = function apply(callback, fn, thisObj, args, index) {
 if ((callback == null)) {
 return __future(apply, arguments, 0) };
 Array.prototype.splice.call(args, ((index != null) ? index : args.length), 0, callback);
 return fn.apply(thisObj, args); };



})(((typeof exports !== "undefined") ? exports : (window.StreamlineFlows = (window.StreamlineFlows || {}))));